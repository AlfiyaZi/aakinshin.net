<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Andrey Akinshin">
    <meta name="description" content="About System.Drawing.Color and operator ==">
    <meta name="keywords" content='.NET,Colors,C#,Equals'>
    <title>About System.Drawing.Color and operator ==</title>
    <link href='/img/favicon.ico' rel='icon' type='image/x-icon'/>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/bootstrap-theme.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet" type="text/css" media="all">
    <link href="/css/about.css" rel="stylesheet" type="text/css" media="all">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <!-- atom & rss feed -->
    <link href="/en/rss.xml" type="application/rss+xml" rel="alternate" title="Blog RSS Feed" />
    <link href="/en/atom.xml" type="application/atom+xml" rel="alternate" title="Blog ATOM Feed" />
    <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-41419012-5', 'auto');
      ga('send', 'pageview');
    </script>
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter28700916 = new Ya.Metrika({id:28700916,
                        clickmap:true,
                        trackLinks:true,
                        accurateTrackBounce:true});
            } catch(e) { }
        });
        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";
        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
    </script>
    <!-- /Yandex.Metrika counter -->
  </head>
  <body data-spy="scroll" data-offset="80">
    <div id="wrap">
      <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="navbar-header">
          <a class="navbar-brand" href="/en/blog/" style="width:80px">Blog</a>
        </div>
        <div class="collapse navbar-collapse" id="jb-navbar-collapse">
          <ul class="nav navbar-nav">
            <li style="width:100px"><a href="/en/blog/content/" class="active">Content</a></li>
            <li style="width:120px"><a href="/en/about/" class="active">About author</a></li>
            <li style="width:140px"><a href='/ru/blog/dotnet/system-drawing-color-equals/' class="active">Russian version</a></li>
          </ul>
        </div>
      </nav>
      <div class="container">
        <div class="row">
  <div class="col-xs-12">
    <div class="row">
      <div class="col-md-9">
        <div id="content-div">
          <div class="page-header">
  <h1>About System.Drawing.Color and operator ==</h1>
</div>

<div class="row post-full">
  <div class="col-xs-12">
    <div class="content">
       <p>Operator <code>==</code> that allows easy comparison of your objects is overridden for many standard structures in .NET. Unfortunately, not every developer really knows what is actually compared when working with this wonderful operator. This brief blog post will show the comparison logic based on a sample of <code>System.Drawing.Color</code>. What do you think the following code will get:</p>
<pre><code class="language-cs">var redName = Color.Red;
var redArgb = Color.FromArgb(255, 255, 0, 0);
Console.WriteLine(redName == redArgb);
</code></pre>
<!--more-->
<p>“It’s red here and it’s red there. Probably, the objects should be equal”, the reader might think. Let’s open <a href="http://www.dotnetframework.org/default.aspx/Net/Net/3@5@50727@3053/DEVDIV/depot/DevDiv/releases/whidbey/netfxsp/ndp/fx/src/CommonUI/System/Drawing/Color@cs/1/Color@cs">source code</a> and review the operator <code>==</code>:</p>
<pre><code class="language-cs">public static bool operator ==(Color left, Color right) {
    if (left.value == right.value
        &amp;&amp; left.state == right.state
        &amp;&amp; left.knownColor == right.knownColor) {

        if (left.name == right.name) {
            return true;
        }

        if (left.name == (object) null || right.name == (object) null) {
            return false;
        }

        return left.name.Equals(right.name);
    }

    return false;
}
</code></pre>
<p>Code review help us make an interesting conclusion: colors are compared by the Name property rather than the ARGB-value. What are the names of our objects? Let’s see.</p>
<pre><code class="language-cs">Console.WriteLine(redName.Name); // Red
Console.WriteLine(redArgb.Name); // ffff0000
</code></pre>
<p>Hmm, they’ve got different names. So, the expression <code>redName == redArgb</code> gets <code>False</code>. There may occur an irritating situation, for example, when initial <code>Color.Red</code> was serialized to ARGB and then de-serialized back and then you decided to compare the final color with the original. Let’s read what <a href="http://msdn.microsoft.com/en-us/library/system.drawing.color.op_equality(v=vs.110).aspx">MSDN</a> says about operator <code>==</code>:</p>
<blockquote>
<p>This method compares more than the ARGB values of the <a href="http://msdn.microsoft.com/en-us/library/system.drawing.color(v=vs.110).aspx">Color</a> structures. It also does a comparison of some state flags. If you want to compare just the ARGB values of two Color structures, compare them using the <a href="http://msdn.microsoft.com/en-us/library/system.drawing.color.toargb(v=vs.110).aspx">ToArgb</a> method.</p>
</blockquote>
<p>Everything is clear now. In order to compare our colors we need the <code>ToArgb</code> method.</p>
<pre><code class="language-cs">Console.WriteLine(redName.ToArgb() == redArgb.ToArgb()); // True
</code></pre>
<h2>Summary</h2>
<p>I think you shouldn’t relay on a guess about logic of the standard comparison methods even if they might seem obvious to you. If you use operator == or Equals method for value types it would be a good idea to have a look at the documentation and check what will be actually compared.</p>
<h2>Cross-posts</h2>
<ul>
<li><a href="http://blogs.perpetuumsoft.com/dotnet/about-system-drawing-color-and-operator/">blogs.perpetuumsoft.com</a></li>
</ul>
    </div>

      Share:
      <a href="https://twitter.com/intent/tweet?text=About System.Drawing.Color and operator ==&url=http://aakinshin.net/en/blog/dotnet/system-drawing-color-equals/&via=andrey_akinshin&related=andrey_akinshin" rel="nofollow" target="_blank" title="Share on Twitter"><img class="profile-image" src="/img/icons/twitter.png" alt="" /></a>
      <a href="https://facebook.com/sharer.php?u=http://aakinshin.net/en/blog/dotnet/system-drawing-color-equals/" rel="nofollow" target="_blank" title="Share on Facebook"><img class="profile-image" src="/img/icons/facebook.png" alt="" /></a>
      <a href="https://plus.google.com/share?url=http://aakinshin.net/en/blog/dotnet/system-drawing-color-equals/" rel="nofollow" target="_blank" title="Share on Google+"><img class="profile-image" src="/img/icons/google-plus.png" alt="" /></a>
      <a href="http://vk.com/share.php?url=http://aakinshin.net/en/blog/dotnet/system-drawing-color-equals/" target="_blank" title="Share on VKontakte"><img class="profile-image" src="/img/icons/vk.png" alt="" /></a>
      <hr />
      <div>
        You can find source code of the post on GitHub:<br />
        <a href="https://github.com/AndreyAkinshin/aakinshin.net/tree/master/_posts/en/dotnet/system-drawing-color-equals.md">https://github.com/AndreyAkinshin/aakinshin.net/tree/master/_posts/en/dotnet/system-drawing-color-equals.md</a>
      </div>
      <div>Contributors:&nbsp;&nbsp;<span id="contributors"></span></div>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
          // Disqus
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'aakinshinnet-en'; // required: replace example with your forum shortname
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
          // Contributors
          var repoFileName = "_posts/en/dotnet/system-drawing-color-equals.md";
          var contributorUrl = "https://api.github.com/repos/AndreyAkinshin/aakinshin.net/commits?path=" + repoFileName;
          $.getJSON(contributorUrl, function(data) {
              var contributorList = $("<span />");
              var contributorSet = {};
              $.each(data, function(index, item) {
                  if(item.author && !contributorSet.hasOwnProperty(item.author.html_url)) {
                      contributorSet[item.author.html_url] = true;
                      var authorImg = $("<img />", {
                          "src": item.author.avatar_url,
                          "title": item.author.login,
                          "width": 32,
                          "height": 32
                      });
                      var authorLink = $("<a />", {
                          "href": item.author.html_url
                      });
                      authorImg.appendTo(authorLink);
                      authorLink.appendTo(contributorList);
                  }
              });
              $("#contributors").fadeOut("fast", function() {
                  $(this).empty().append(contributorList).fadeIn(1000);
              });
          });
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</div>
        </div>
      </div>
      <div class="col-md-3">
        <div id="sidebar-right">
          <b style="font-size:150%">Andrey Akinhin's blog</b><br />
          <img src="/img/icons/email.png" alt="" /><br />
          <img src="/img/misc/mvp-logo.png" alt="" /><br />
          <b>Profiles</b>
          <aside id="sidebar-right-profiles">
            <a href="https://github.com/AndreyAkinshin" title="GitHub">                            <img src="/img/icons/github.png" alt="" /></a>
            <a href="https://twitter.com/andrey_akinshin" title="Twitter">                         <img src="/img/icons/twitter.png" alt="" /></a>
            <a href="http://habrahabr.ru/users/dreamwalker" title="Habrahabr">                     <img src="/img/icons/habr.png" alt="" /></a>
            <a href="http://stackoverflow.com/users/184842/AndreyAkinshin" title="StackOverflow">  <img src="/img/icons/stackoverflow.png" alt=""></a>
            <a href="https://coderbits.com/Akinshin" title="CoderBits">                            <img src="/img/icons/coderbits.png" alt="" /></a>
            <a href="http://mvp.microsoft.com/en-us/mvp/Andrey%20Akinshin-5001348" title="Microsoft MVP"> <img src="/img/icons/mvp.png" alt="" /></a>
            <a href="http://www.goodreads.com/AndreyAkinshin" title="GoodReads">                   <img src="/img/icons/goodreads.png" alt="" /></a>
            <a href="http://www.slideshare.net/AndreyAkinshin" title="SlideShare">                 <img src="/img/icons/slideshare.png" alt="" /></a>
            <a href="http://www.linkedin.com/in/AndreyAkinshin" title="LinkedIn">                  <img src="/img/icons/linkedin.png" alt="" /></a>
            <a href="https://plus.google.com/+AndreyAkinshinRu" title="Google+">                   <img src="/img/icons/google-plus.png" alt="" /></a>
            <a href="https://www.facebook.com/aakinshin.ru" title="Facebook">                      <img src="/img/icons/facebook.png" alt="" /></a>
            <a href="http://acm.timus.ru/author.aspx?id=27570" title="Timus">                      <img src="/img/icons/timus.png" alt="" /></a>
            <a href="https://www.diigo.com/user/AndreyAkinshin" title="Diigo">                     <img src="/img/icons/diigo.png" alt="" /></a>
            <a href="https://www.researchgate.net/profile/Andrey_Akinshin" title="ResearchGate">   <img src="/img/icons/research-gate.png" alt="" /></a>
            <a href="http://www.mendeley.com/profiles/andrey-akinshin/" title="Mendeley">          <img src="/img/icons/mendeley.png" alt="" /></a>
            <a href="http://www.mathnet.ru/php/person.phtml?personid=79053" title="MathNet">       <img src="/img/icons/math-net.png" alt="" /></a>
            <a href="http://elibrary.ru/author_items.asp?authorid=676806" title="elibrary">        <img src="/img/icons/elibrary.png" alt="" /></a>
            <a href="http://scholar.google.ru/citations?user=rYVl83IAAAAJ" title="Google Scholar"> <img src="/img/icons/google-scholar.png" alt="" /></a>
          </aside>
          <br />
          <b>Projects</b>
          <aside>
            <ul>
              <li><a href="http://problembook.net/">ProblemBook.NET</a></li>
              <li><a href="https://github.com/AndreyAkinshin/Russian-Phd-LaTeX-Dissertation-Template">LaTeX-templte for Phd thesis</a></li>
              <li><a href="https://github.com/AndreyAkinshin/BenchmarkDotNet">BenchmarkDotNet</a></li>
            </ul>
          </aside>
          <b>Selected posts</b>
          <aside>
            <i>.NET</i>
            <ul>
              <li><a href="/en/blog/dotnet/inlining-and-starg/">A story about JIT-x86 inlining and starg</a></li>
              <li><a href="/en/blog/dotnet/mono-utf8-conversions/">About UTF-8 conversions in Mono</a></li>
              <li><a href="/en/blog/dotnet/system-drawing-color-equals/">About System.Drawing.Color and operator ==</a></li>
              <li><a href="/en/blog/dotnet/msbuild-configurations/">Setting up build configuration in .NET</a></li>
              <li><a href="/en/blog/dotnet/jon-skeet-quiz/">Jon Skeet's Quiz</a></li>
              <li><a href="/en/blog/dotnet/gc-native/">Unexpected area to collect garbage in .NET</a></li>
              <li><a href="/en/blog/dotnet/closures/">Unobviousness in use of C# closures</a></li>
              <li><a href="/en/blog/dotnet/wrap-cs-in-com/">Wrapping C# class for use in COM</a></li>
            </ul>
            <i>Development</i>
            <ul>
              <li><a href="/en/blog/dev/refactoring/">To Refactor Or Not To Refactor?</a></li>
              <li><a href="/en/blog/dev/comments/">To Add Comments Or Not To Add?</a></li>
              <li><a href="/en/blog/dev/perfect-code-and-real-projects/">Perfect code and real projects</a></li>
            </ul>
          </aside>
          <b>Subscribe</b>
          <aside>
            <a href="/en/rss.xml"><i class="icon-connection"></i>RSS</a>&nbsp;
            <a href="/en/atom.xml"><i class="icon-connection"></i>Atom</a>
          </aside>
        </div>
      </div>
    </div>
  </div>
</div>
      </div>
    </div>
    <div id="footer">
      <div class="container">
        <p>&copy; 2014–2015 Andrey Akinshin</p>
      </div>
    </div>
    <script>
    $(function() {
      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({
              scrollTop: target.offset().top-70
            }, 1000, 'swing', function () {
             $("a").blur();
            });
            return false;
          }
        }
      });
    });
    $(function() {
       $('table').not(".table-ok").addClass("table");
       $('table').not(".table-ok").addClass("table-bordered");
       // $('table').not(".table-ok").addClass("table-striped");
    });
    (function($, window, undefined) {
      // Add pretty print to all pre and code tags.
      $('pre, code').addClass("prettyprint");
      // Remove prettify from code tags inside pre tags.
      $('pre code').removeClass("prettyprint");
    })(jQuery, this);
    </script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
  </body>
</html>
